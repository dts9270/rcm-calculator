<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DS WORLD ‚Äì RCM ‡§¨‡§ö‡§§ ‡§ï‡•Ö‡§≤‡•ç‡§ï‡•ç‡§Ø‡•Å‡§≤‡•á‡§ü‡§∞</title>

<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>

/* ============================
   COLOR THEME (OLD UI)
============================ */
:root{
  --primary:#0a5b99;
  --secondary:#138808;
  --purple:#8A56FF;
  --bg:#f4f4f4;
  --card:#ffffff;
  --text:#333;
  --muted:#666;
  --border:#e0e0e0;
}

body{
  margin:0;
  font-family:"Poppins",sans-serif;
  background:var(--bg);
  color:var(--text);
}

/* ============================
     WRAPPER
============================ */
.wrap{
  max-width:900px;
  margin:12px auto;
  background:var(--card);
  border-radius:14px;
  padding:18px;
  box-shadow:0 4px 12px rgba(0,0,0,0.05);
  border-top:5px solid var(--primary);
}

/* ============================
      HEADER (OLD UI)
============================ */
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  flex-wrap:wrap;     /* FIX */
}

.brand{
  display:flex;
  align-items:center;
  gap:12px;
  flex-wrap:wrap;     /* FIX */
}

.logo{
  width:60px;
  height:60px;
  border-radius:14px;
  background:white;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
  flex-shrink:0;       /* FIX */
  box-shadow:0 4px 10px rgba(0,0,0,0.1);
}

.logo img{
  width:100%;
  height:100%;
  object-fit:contain;
}

.header-text{
  display:flex;
  flex-direction:column;
  min-width:180px;     /* FIX */
}

h1{
  margin:0;
  font-family:"Baloo 2",sans-serif;
  color:var(--primary);
  font-size:24px;
}

.small{
  font-size:13px;
  color:var(--muted);
}

/* ============================
     PRODUCT FORM
============================ */
.section{
  background:var(--card);
  padding:18px;
  border-radius:12px;
  margin-top:20px;
  border:1px solid #eaf1f8;
}

h2{
  font-family:"Baloo 2";
  margin:0 0 12px 0;
  color:var(--primary);
}

.controls{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
}

.controls input, .controls select{
  padding:10px;
  border:1px solid var(--border);
  border-radius:8px;
}

.btn{
  padding:10px 14px;
  border-radius:10px;
  border:none;
  font-weight:700;
  cursor:pointer;
}

.btn.add{background:var(--primary);color:white;width:100%;}

/* ============================
     PRODUCT LIST OLD UI
============================ */
.product-item{
  background:#fafcff;
  padding:12px;
  border-radius:10px;
  border:1px solid var(--border);
  margin-bottom:10px;
  display:flex;
  justify-content:space-between;
  flex-wrap:wrap;
}

.product-name{
  font-weight:700;
  color:var(--primary);
}

.product-pricing{
  font-size:13px;
  color:var(--muted);
}

.product-saving{
  color:var(--secondary);
  font-weight:700;
  margin-top:4px;
}

/* ============================
     TOTALS
============================ */
.totals-summary{
  margin-top:15px;
  border-top:2px solid var(--primary);
  padding-top:10px;
}

.total-row{
  display:flex;
  justify-content:space-between;
  padding:6px 0;
}

.total-row.highlight{
  background:#e6f7ff;
  padding:10px;
  border-radius:6px;
}

/* ============================
     CARDS (OLD UI)
============================ */
.cards-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:12px;
  margin-top:14px;
}

.card{
  padding:16px;
  border-radius:14px;
  color:white;
  font-weight:700;
  text-align:center;
}

.card.saving{background:linear-gradient(135deg,#ff9933,#ff7b07)}
.card.cons{background:linear-gradient(135deg,#8A56FF,#6A3DCC)}
.card.total{background:linear-gradient(135deg,#138808,#0d5f06)}
.card.secondary{background:linear-gradient(135deg,#00796B,#004D40)}

/* ============================
     FOOTER
============================ */
.bottom-actions{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  margin-top:16px;
}

footer{
  text-align:center;
  margin-top:20px;
  font-weight:700;
  color:#555;
}

/* ============================
      MOBILE FIXES
============================ */
@media(max-width:600px){

  .brand{
    flex-direction:column;
    align-items:center;
    text-align:center;
  }

  .logo{
    width:55px;
    height:55px;
  }

  h1{font-size:20px;}

  .wrap{padding:12px;}

  .controls{flex-direction:column;}

  .btn.add{width:100%;}
}

</style>
</head>

<body>

<div class="wrap">

<header>
  <div class="brand">
    <div class="logo"><img src="logo.png" alt=""></div>
    <div class="header-text">
      <h1>RCM ‡§¨‡§ö‡§§ ‡§ï‡•Ö‡§≤‡•ç‡§ï‡•ç‡§Ø‡•Å‡§≤‡•á‡§ü‡§∞</h1>
      <div class="small" id="nowDate"></div>
    </div>
  </div>

  <div style="font-weight:700;color:var(--primary)">üìû 7020970727</div>
</header>

<!-- START YOUR OLD UI BODY BELOW -->
<!-- ‡§Æ‡•Ä ‡§ï‡§æ‡§π‡•Ä‡§ö ‡§¨‡§¶‡§≤‡§≤‡•á ‡§®‡§æ‡§π‡•Ä ‚Äî ‡§§‡•Å‡§ù‡§æ full old UI ‡§Ø‡•á‡§•‡•á ‡§†‡•á‡§µ -->

<div class="section">
  <h2>‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§ç‡§° ‡§ï‡§∞‡§æ</h2>

  <div class="controls">
    <select id="productSelect"><option value="">-- Loading --</option></select>
    <input type="number" id="qtyInput" min="1" value="1">
    <button class="btn add" id="addBtn">+ Add</button>
  </div>
</div>

<div class="section">
  <h2>‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§ë‡§∞‡•ç‡§°‡§∞</h2>
  <div id="productList"></div>

  <div class="totals-summary">
    <div class="total-row"><span>Qty:</span><strong id="totalQty">0</strong></div>
    <div class="total-row"><span>Market:</span><strong id="totalMarket">‚Çπ0</strong></div>
    <div class="total-row"><span>RCM:</span><strong id="totalRCM">‚Çπ0</strong></div>
    <div class="total-row"><span>PV:</span><strong id="totalPV">0</strong></div>
    <div class="total-row highlight"><span>Saving:</span><strong id="totalSaving">‚Çπ0</strong></div>
  </div>
</div>

<div class="section">
  <h2>‡§§‡•Å‡§Æ‡§ö‡§æ ‡§´‡§æ‡§Ø‡§¶‡§æ</h2>

  <div class="cards-grid">
    <div class="card saving">
      <div class="label">‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
      <div id="cardMonthly" class="val">‚Çπ0</div>
    </div>

    <div class="card cons">
      <div class="label">Consistency</div>
      <div id="cardCons" class="val">‚Çπ0</div>
    </div>

    <div class="card total">
      <div class="label">‡§è‡§ï‡•Ç‡§£ ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
      <div id="cardTotal" class="val">‚Çπ0</div>
    </div>

    <div class="card secondary">
      <div class="label">‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï</div>
      <div id="cardAnnual" class="val">‚Çπ0</div>
    </div>

    <div class="card secondary">
      <div class="label">20 ‡§µ‡§∞‡•ç‡§∑‡•á</div>
      <div id="cardTwenty" class="val">‚Çπ0</div>
    </div>
  </div>
</div>

<div class="bottom-actions">
  <button class="btn wa" id="waBtn" style="background:#25D366;color:white">WhatsApp</button>
  <button class="btn pdf" id="pdfBtn" style="background:#ff7043;color:white">PDF</button>
  <button class="btn img" id="imgBtn" style="background:#0066cc;color:white">Image</button>
  <button class="btn clear" id="clearBtn" style="background:red;color:white">Clear</button>
</div>

<footer>
  Designed by DS WORLD üåç | 7020970727
</footer>

</div>

<!-- OLD SCRIPT (‡§Æ‡•Ä ‡§¨‡§¶‡§≤‡§≤‡•á ‡§®‡§æ‡§π‡•Ä ‚Äî ‡§´‡§ï‡•ç‡§§ ‡§õ‡•ã‡§ü‡§æ FIX) -->

<script>
document.getElementById('nowDate').innerText =
  new Date().toLocaleDateString('mr-IN',{day:"2-digit",month:"short",year:"numeric"});

let products=[];
let order=[];
const SHEET_URL="https://docs.google.com/spreadsheets/d/1eR5THz-4AV3HkfnNJ5Un48ksz0I0jrepJSED3qHFg6k/gviz/tq?tqx=out:json";

async function loadProducts(){
  let r=await fetch(SHEET_URL);
  let txt=await r.text();
  let json=JSON.parse(txt.substring(47,txt.length-2));

  products=json.table.rows.map(r=>({
    name:r.c[0]?.v || "",
    market:+r.c[1]?.v || 0,
    rcm:+r.c[2]?.v || 0,
    pv:+r.c[3]?.v || 0
  }));

  productSelect.innerHTML = `<option value="">-- Select --</option>`;
  products.forEach((p,i)=>{
    let o=document.createElement("option");
    o.value=i;
    o.textContent=p.name;
    productSelect.appendChild(o);
  });
}
loadProducts();

function fmt(n){return Math.round(n)}

function calc(){
  let list=document.getElementById("productList");
  list.innerHTML="";

  let tq=0, tm=0, tr=0, tp=0, ts=0;

  order.forEach((it,i)=>{
    tq+=it.qty;
    tm+=it.qty*it.market;
    tr+=it.qty*it.rcm;
    tp+=it.qty*it.pv;
    ts+=it.qty*(it.market-it.rcm);

    let div=document.createElement("div");
    div.className="product-item";

    div.innerHTML=`
      <div style="flex:1">
        <div class="product-name">${it.name}</div>
        <div class="product-pricing">PV:${it.pv} | M:‚Çπ${it.market} | RCM:‚Çπ${it.rcm}</div>
        <div class="product-saving">‡§¨‡§ö‡§§: ‚Çπ${fmt(it.qty*(it.market-it.rcm))}</div>
      </div>

      <div style="text-align:right">
        <button onclick="order[${i}].qty=Math.max(1,order[${i}].qty-1);calc()" class="btn">-</button>
        <span style="font-weight:700">${it.qty}</span>
        <button onclick="order[${i}].qty++;calc()" class="btn">+</button>
      </div>
    `;

    list.appendChild(div);
  });

  totalQty.innerText = tq;
  totalMarket.innerText = "‚Çπ"+fmt(tm);
  totalRCM.innerText = "‚Çπ"+fmt(tr);
  totalPV.innerText = fmt(tp);
  totalSaving.innerText = "‚Çπ"+fmt(ts);

  // consistency
  let cons=0;
  if(tp<1500) cons = tp*0.12;
  else if(tp<2500) cons = 1500*0.1667;
  else cons = 5000*0.1667;

  let monthly = ts + cons;

  cardMonthly.innerText="‚Çπ"+fmt(monthly);
  cardCons.innerText="‚Çπ"+fmt(cons);
  cardTotal.innerText="‚Çπ"+fmt(monthly);
  cardAnnual.innerText="‚Çπ"+fmt(monthly*12);
  cardTwenty.innerText="‚Çπ"+fmt(monthly*12*20);
}

addBtn.onclick=()=>{
  let idx=productSelect.value;
  if(idx==="") return alert("Product ‡§®‡§ø‡§µ‡§°‡§æ");

  let qty = Math.max(1,parseInt(qtyInput.value)||1);
  let p=products[idx];

  let ex=order.find(o=>o.name===p.name);
  if(ex) ex.qty+=qty;
  else order.push({...p,qty});

  calc();
};

clearBtn.onclick=()=>{
  if(confirm("Clear ‡§ï‡§∞‡§æ‡§Ø‡§ö‡•á?")){
    order=[];calc();
  }
};

waBtn.onclick=()=>{
  let msg="*RCM Summary*\n\n";

  order.forEach((it,i)=>{
    msg+=`${i+1}. ${it.name} ‚Äî ${it.qty}\n`;
  });

  msg+=`\nPV: ${totalPV.innerText}`;
  msg+=`\nMonthly: ${cardMonthly.innerText}`;
  msg+=`\nYearly: ${cardAnnual.innerText}`;
  msg+=`\n20 Years: ${cardTwenty.innerText}`;

  window.open("https://wa.me/?text="+encodeURIComponent(msg));
};

</script>

</body>
</html>
