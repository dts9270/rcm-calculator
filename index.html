<!doctype html>
<html lang="mr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>RCM ‡§¨‡§ö‡§§ ‡§ï‡•Ö‡§≤‡•ç‡§ï‡•ç‡§Ø‡•Å‡§≤‡•á‡§ü‡§∞ ‚Äî DS WORLD (Pro)</title>

<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
  :root{
    --primary:#0a5b99;
    --accent:#0ea44a;
    --muted:#6b7280;
    --card:#ffffff;
    --glass: rgba(255,255,255,0.9);
    --shadow: 0 10px 30px rgba(15,40,80,0.08);
    --glass-border: #e6f0ff;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:"Poppins",sans-serif;
    background: linear-gradient(180deg,#f6fbff 0%, #f4f7fb 100%);
    color:#0f1724;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }
  .wrap{max-width:1100px;margin:18px auto;padding:18px;}
  header{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
  .brand{display:flex;align-items:center;gap:12px}
  .logo{width:62px;height:62px;background:#fff;border-radius:12px;padding:8px;box-shadow:0 6px 18px rgba(10,60,120,0.06);display:flex;align-items:center;justify-content:center}
  .logo img{max-width:100%;height:auto}
  h1{margin:0;font-family:"Baloo 2";font-size:20px;color:var(--primary)}
  .now{font-size:13px;color:var(--muted)}
  .ds-badge{background:linear-gradient(90deg,var(--primary),#0070c4);padding:8px 14px;border-radius:999px;color:#fff;font-weight:700;box-shadow:0 6px 18px rgba(0,112,196,0.12)}

  /* layout */
  .grid{display:grid;grid-template-columns:1fr 360px;gap:18px;margin-top:16px}
  @media(max-width:980px){.grid{grid-template-columns:1fr}}
  .card{background:var(--card);padding:16px;border-radius:12px;border:1px solid var(--glass-border);box-shadow:var(--shadow)}

  /* input rows */
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .field{flex:1;min-width:150px}
  label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
  input[type="text"], input[type="date"], select, input[type="number"]{
    width:100%;padding:10px;border-radius:10px;border:1px solid #e6eef8;background:#fff;font-size:14px
  }

  .section{margin-top:14px}
  .section h2{margin:0 0 12px 0;font-family:"Baloo 2";color:var(--primary);font-size:16px}

  /* product list */
  #productList{margin-top:10px;max-height:380px;overflow:auto;padding-right:6px}
  .prod-item{display:flex;align-items:center;gap:12px;padding:12px;border-radius:10px;border:1px solid #f0f6ff;background:#fbfdff;margin-bottom:10px}
  .prod-thumb{width:56px;height:56px;border-radius:8px;background:#fff;border:1px solid #f0f6ff;display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--muted)}
  .prod-meta{flex:1}
  .prod-meta .title{font-weight:700;color:var(--primary)}
  .prod-meta .sub{font-size:13px;color:var(--muted);margin-top:4px}
  .qty-controls{display:flex;align-items:center;gap:8px}

  .btn{padding:10px 12px;border:none;border-radius:10px;font-weight:700;cursor:pointer}
  .btn-add{background:linear-gradient(90deg,var(--primary),#006fbf);color:#fff}
  .btn-ghost{background:#f5f7fb;border:1px solid #e7eefc;color:var(--primary);padding:8px 10px;border-radius:8px}

  /* Big premium cards */
  .cards{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
  @media(max-width:480px){.cards{grid-template-columns:1fr}}
  .big-card{border-radius:14px;padding:18px;color:#fff;position:relative;overflow:hidden;min-height:110px;display:flex;flex-direction:column;justify-content:center;gap:6px;box-shadow:0 10px 30px rgba(10,30,70,0.08)}
  .big-card .label{font-size:13px;opacity:0.9}
  .big-card .val{font-size:28px;font-weight:800}
  .big-card .icon{position:absolute;right:14px;top:12px;font-size:34px;opacity:0.15}
  .card-saving{background:linear-gradient(135deg,#3fc77d,#1aa24a)}
  .card-cons{background:linear-gradient(135deg,#8b5cf6,#6d3be8)}
  .card-year{background:linear-gradient(135deg,#3aa0ff,#006fbf)}
  .card-life{background:linear-gradient(135deg,#ffaf4b,#ff8a00)}

  /* order summary */
  .summary{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:12px}
  .sum-box{background:#fff;border:1px solid #eef6ff;padding:10px;border-radius:10px;text-align:center}
  .sum-box .k{font-size:13px;color:var(--muted)}
  .sum-box .v{font-weight:800;font-size:18px;margin-top:6px;color:var(--primary)}

  /* buttons */
  .ios-btn{width:100%;padding:14px;border-radius:28px;border:none;font-weight:700;color:#fff;margin-bottom:12px;cursor:pointer}
  .ios-wa{background:linear-gradient(135deg,#1bd741,#0fbf32)}
  .ios-img{background:linear-gradient(135deg,#3c8bff,#1b6eff)}
  .ios-pdf{background:linear-gradient(135deg,#ff964f,#ff7a1c)}
  .ios-clear{background:linear-gradient(135deg,#ff4a4a,#d62828)}

  /* floating add */
  .floating-add{position:fixed;right:20px;bottom:20px;width:62px;height:62px;border-radius:50%;background:linear-gradient(135deg,var(--primary),#006fbf);color:#fff;font-size:34px;border:none;display:flex;align-items:center;justify-content:center;box-shadow:0 12px 30px rgba(6,60,120,0.12);cursor:pointer;z-index:1200}
  .floating-add:active{transform:scale(.96)}

  /* overlay popup & toast */
  .overlay{position:fixed;left:0;top:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;background:rgba(7,18,34,0.28);z-index:1400}
  .popup{background:var(--card);padding:18px;border-radius:12px;min-width:280px;text-align:center;box-shadow:0 20px 40px rgba(10,30,60,0.12)}
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:110px;background:#0b1324;color:#fff;padding:10px 14px;border-radius:12px;font-weight:700;z-index:1500;opacity:0;transition:opacity .28s,transform .28s}

  /* splash */
  #splash{position:fixed;left:0;top:0;width:100%;height:100%;background:linear-gradient(135deg,#ffffff,#eaf6ff);display:flex;align-items:center;justify-content:center;z-index:2000;flex-direction:column}
  #splash .logoWrap{width:140px;height:140px;border-radius:20px;background:linear-gradient(180deg,#fff,#f2fbff);display:flex;align-items:center;justify-content:center;box-shadow:0 20px 50px rgba(10,40,90,0.08)}
  #splash h3{margin:18px 0 0 0;font-family:"Baloo 2";color:var(--primary)}
  .fadeUp{animation:fadeUp .9s ease both}
  @keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>

<div id="splash" aria-hidden="false">
  <div class="logoWrap fadeUp">
    <div style="text-align:center">
      <img src="logo.png" alt="logo" style="width:72px;height:72px;object-fit:contain">
    </div>
  </div>
  <h3 class="fadeUp">DS WORLD ‚Äî RCM ‡§¨‡§ö‡§§ ‡§ï‡•Ö‡§≤‡•ç‡§ï‡•ç‡§Ø‡•Å‡§≤‡•á‡§ü‡§∞</h3>
</div>

<div class="wrap" id="app" aria-hidden="true">
  <header>
    <div class="brand">
      <div class="logo"><img src="logo.png" alt="logo" onerror="this.style.display='none'"></div>
      <div>
        <h1>RCM ‡§¨‡§ö‡§§ ‡§ï‡•Ö‡§≤‡•ç‡§ï‡•ç‡§Ø‡•Å‡§≤‡•á‡§ü‡§∞</h1>
        <div class="now" id="nowDate">--</div>
      </div>
    </div>
    <div class="ds-badge">‚ú® DS WORLD</div>
  </header>

  <div class="grid">
    <!-- LEFT -->
    <div>
      <div class="card">
        <div class="row">
          <div class="field">
            <label>‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§ö‡•á ‡§®‡§æ‡§µ</label>
            <input id="custName" type="text" placeholder="‡§®‡§æ‡§µ">
          </div>
          <div class="field">
            <label>RCM ID</label>
            <input id="rcmId" type="text" placeholder="RCM ID">
          </div>
          <div class="field">
            <label>‡§ë‡§∞‡•ç‡§°‡§∞ ‡§§‡§æ‡§∞‡•Ä‡§ñ</label>
            <input id="orderDate" type="date">
          </div>
        </div>

        <div class="section">
          <h2>‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§ç‡§° ‡§ï‡§∞‡§æ</h2>
          <div style="margin-bottom:10px">
            <input id="search" placeholder="‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§∂‡•ã‡§ß‡§æ..." style="width:100%;padding:10px;border-radius:10px;border:1px solid #eef6ff">
          </div>
          <div class="row">
            <select id="productSelect" style="flex:1"><option value="">-- ‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§®‡§ø‡§µ‡§°‡§æ --</option></select>
            <input id="qtyInput" type="number" min="1" value="1" style="width:100px;border-radius:10px">
            <button id="addBtn" class="btn btn-add">+ ‡§ç‡§° ‡§ï‡§∞‡§æ</button>
          </div>

          <div id="productList"></div>

          <div class="section" style="margin-top:12px">
            <h2>Order Summary</h2>
            <div class="summary">
              <div class="sum-box"><div class="k">‡§è‡§ï‡•Ç‡§£ ‡§®‡§ó</div><div id="totalQty" class="v">0</div></div>
              <div class="sum-box"><div class="k">‡§è‡§ï‡•Ç‡§£ ‡§Æ‡§æ‡§∞‡•ç‡§ï‡•á‡§ü ‡§ï‡§ø‡§Ç‡§Æ‡§§</div><div id="totalMarket" class="v">‚Çπ0</div></div>
              <div class="sum-box"><div class="k">‡§è‡§ï‡•Ç‡§£ RCM ‡§ï‡§ø‡§Ç‡§Æ‡§§</div><div id="totalRCM" class="v">‚Çπ0</div></div>
              <div class="sum-box"><div class="k">‡§è‡§ï‡•Ç‡§£ PV</div><div id="totalPV" class="v">0</div></div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- RIGHT -->
    <div>
      <div class="card cards">
        <div class="big-card card-saving">
          <div class="label">üí∞ ‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§¨‡§ö‡§§</div>
          <div class="val" id="cardMonthly">‚Çπ0</div>
          <div class="icon">üí∞</div>
        </div>
        <div class="big-card card-cons">
          <div class="label">üéØ Consistency Reward</div>
          <div class="val" id="cardCons">‚Çπ0</div>
          <div class="icon">üéØ</div>
        </div>

        <div class="big-card card-year">
          <div class="label">üìÖ ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
          <div class="val" id="cardAnnual">‚Çπ0</div>
          <div class="icon">üìÖ</div>
        </div>
        <div class="big-card card-life">
          <div class="label">üèÜ 20 ‡§µ‡§∞‡•ç‡§∑‡§æ‡§Ç‡§ö‡§æ ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
          <div class="val" id="cardTwenty">‚Çπ0</div>
          <div class="icon">üèÜ</div>
        </div>
      </div>

      <div class="card" style="margin-top:12px">
        <button id="waBtn" class="ios-btn ios-wa">üì≤ ‡§µ‡•ç‡§π‡•â‡§ü‡•ç‡§∏‡§Ö‡§™‡§µ‡§∞ ‡§™‡§æ‡§†‡§µ‡§æ</button>
        <button id="imgBtn" class="ios-btn ios-img">üñºÔ∏è ‡§á‡§Æ‡•á‡§ú ‡§∂‡•á‡§Ö‡§∞</button>
        <button id="pdfBtn" class="ios-btn ios-pdf">üìÑ ‡§á‡§®‡§µ‡•ç‡§π‡•â‡§á‡§∏ PDF</button>
        <button id="clearBtn" class="ios-btn ios-clear">üóë ‡§ë‡§∞‡•ç‡§°‡§∞ ‡§ï‡•ç‡§≤‡§ø‡§Ö‡§∞ ‡§ï‡§∞‡§æ</button>
      </div>
    </div>
  </div>

  <div style="margin-top:14px" class="card">
    <h2>Order Summary (‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§)</h2>
    <div style="display:flex;gap:12px;flex-wrap:wrap">
      <div style="flex:1;min-width:220px;padding:12px;border-radius:10px;border:1px solid #eef6ff;background:#fff">
        <div style="font-size:13px;color:var(--muted)">‡§è‡§ï‡•Ç‡§£ ‡§¨‡§ö‡§§</div>
        <div id="totalSaving" style="font-weight:800;font-size:20px;margin-top:6px;color:var(--accent)">‚Çπ0</div>
      </div>
      <div style="flex:1;min-width:220px;padding:12px;border-radius:10px;border:1px solid #eef6ff;background:#fff">
        <div style="font-size:13px;color:var(--muted)">Final Benefit</div>
        <div id="finalBenefit" style="font-weight:800;font-size:20px;margin-top:6px;color:var(--primary)">‚Çπ0</div>
      </div>
      <div style="flex:1;min-width:220px;padding:12px;border-radius:10px;border:1px solid #eef6ff;background:#fff">
        <div style="font-size:13px;color:var(--muted)">Consistency % (approx)</div>
        <div id="consPercent" style="font-weight:800;font-size:20px;margin-top:6px;color:#6b21a8">0%</div>
      </div>
    </div>
  </div>

  <footer style="margin-top:14px;text-align:center;color:var(--muted);font-weight:700">
    Designed by DS WORLD üåç ‚Ä¢ 7020970727
  </footer>
</div>

<!-- overlays -->
<div id="overlay" class="overlay" aria-hidden="true">
  <div class="popup">
    <h3 id="popTitle">‚úî ‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§ú‡•ã‡§°‡§≤‡•á</h3>
    <p id="popSub">‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§¨‡§ö‡§§: ‚Çπ0</p>
  </div>
</div>

<div id="toast" class="toast" aria-hidden="true">Saved ‚úì</div>

<button class="floating-add" id="floatAdd">+</button>

<!-- libs -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

<script>
/* ---------- Configuration ---------- */
// If you want to load from your Google Sheet, replace SHEET_URL below.
// Make sure sheet is "Anyone with link can view" and columns: name, market, rcm, pv, [optional image]
const SHEET_URL = "https://docs.google.com/spreadsheets/d/1eR5THz-4AV3HkfnNJ5Un48ksz0I0jrepJSED3qHFg6k/gviz/tq?tqx=out:json";

/* ---------- State ---------- */
let products = [];
let order = [];

/* ---------- DOM refs ---------- */
const productSelect = document.getElementById('productSelect');
const productList = document.getElementById('productList');
const qtyInput = document.getElementById('qtyInput');
const search = document.getElementById('search');

const totalQty = document.getElementById('totalQty');
const totalMarket = document.getElementById('totalMarket');
const totalRCM = document.getElementById('totalRCM');
const totalPV = document.getElementById('totalPV');
const totalSaving = document.getElementById('totalSaving');

const cardMonthly = document.getElementById('cardMonthly');
const cardCons = document.getElementById('cardCons');
const cardAnnual = document.getElementById('cardAnnual');
const cardTwenty = document.getElementById('cardTwenty');
const finalBenefit = document.getElementById('finalBenefit');
const consPercent = document.getElementById('consPercent');

const overlay = document.getElementById('overlay');
const popTitle = document.getElementById('popTitle');
const popSub = document.getElementById('popSub');
const toast = document.getElementById('toast');

/* ---------- Utilities ---------- */
function fmt(n){ return Math.round(n).toLocaleString('en-IN'); }
function showToast(msg){ toast.innerText = msg; toast.style.opacity = 1; setTimeout(()=> toast.style.opacity = 0,1500); }
function showPopup(name){ popTitle.innerText = "‚úî " + name + " ‡§ú‡•ã‡§°‡§≤‡•á!"; popSub.innerText = "‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§¨‡§ö‡§§: " + document.getElementById('totalSaving').innerText; overlay.style.display = 'flex'; setTimeout(()=> overlay.style.display='none',1600); }

/* ---------- Splash hide ---------- */
window.addEventListener('load', ()=>{
  setTimeout(()=>{ document.getElementById('splash').style.display='none'; document.getElementById('app').removeAttribute('aria-hidden'); }, 1100);
});

/* ---------- Time ---------- */
function updateTime(){ document.getElementById('nowDate').innerText = new Date().toLocaleString('mr-IN',{day:'2-digit',month:'short',year:'numeric',hour:'2-digit',minute:'2-digit'}); }
updateTime(); setInterval(updateTime,1000);
document.getElementById('orderDate').valueAsDate = new Date();

/* ---------- Load products (Google Sheet) ---------- */
async function loadProducts(){
  try{
    const res = await fetch(SHEET_URL);
    const txt = await res.text();
    const json = JSON.parse(txt.substring(47, txt.length - 2));
    products = json.table.rows.map(r => ({
      name: r.c[0]?.v || "",
      market: +r.c[1]?.v || 0,
      rcm: +r.c[2]?.v || 0,
      pv: +r.c[3]?.v || 0,
      img: r.c[4]?.v || null
    })).filter(p=>p.name);
  }catch(err){
    // fallback demo products
    products = [
      {name:"‡§ü‡§æ‡§ü‡§æ ‡§Æ‡•Ä‡§† 1 ‡§ï‡§ø‡§≤‡•ã", market:30, rcm:20, pv:7, img:null},
      {name:"‡§∞‡•á‡§° ‡§≤‡•á‡§¨‡§≤ ‡§ö‡§π‡§æ 500g", market:310, rcm:240, pv:120, img:null},
      {name:"‡§®‡•ç‡§Ø‡•Ç‡§ü‡•ç‡§∞‡§ø‡§≤‡§æ‡§á‡§ü", market:560, rcm:320, pv:270, img:null}
    ];
  }
  populateProducts();
  loadSavedOrder();
  recalc();
}
loadProducts();

/* ---------- Populate dropdown / search ---------- */
function populateProducts(){
  productSelect.innerHTML = "<option value=''>-- ‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§®‡§ø‡§µ‡§°‡§æ --</option>";
  products.forEach((p,i)=>{ let opt=document.createElement('option'); opt.value=i; opt.textContent=p.name; productSelect.appendChild(opt); });
}
search.addEventListener('input', ()=>{
  const q = search.value.trim().toLowerCase();
  productSelect.innerHTML = "<option value=''>-- ‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§®‡§ø‡§µ‡§°‡§æ --</option>";
  products.forEach((p,i)=>{ if(p.name.toLowerCase().includes(q)) { let opt=document.createElement('option'); opt.value=i; opt.textContent=p.name; productSelect.appendChild(opt); }});
});

/* ---------- Add product ---------- */
document.getElementById('addBtn').addEventListener('click', ()=>{
  const idx = productSelect.value;
  if(idx === "") return alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§®‡§ø‡§µ‡§°‡§æ');
  const qty = Math.max(1, parseInt(qtyInput.value) || 1);
  const p = products[Number(idx)];
  const exists = order.find(o => o.name === p.name);
  if(exists) exists.qty += qty; else order.push({...p, qty});
  saveOrder();
  recalc();
  showPopup(p.name);
  showToast('Saved ‚úì');
});

/* floating add */
document.getElementById('floatAdd').addEventListener('click', ()=> document.getElementById('addBtn').click());

/* ---------- Save / Load order ---------- */
function saveOrder(){ localStorage.setItem('rcm_order', JSON.stringify(order)); }
function loadSavedOrder(){ const s = localStorage.getItem('rcm_order'); if(s) order = JSON.parse(s); }

/* ---------- Recalculate & render ---------- */
function recalc(){
  productList.innerHTML = '';
  let tQty=0, tM=0, tR=0, tPV=0, tSave=0;
  if(order.length === 0) productList.innerHTML = "<div style='color:#667085;padding:12px'>‡§ë‡§∞‡•ç‡§°‡§∞ ‡§∞‡§ø‡§ï‡§æ‡§Æ‡•Ä ‡§Ü‡§π‡•á.</div>";
  order.forEach((it, idx)=>{
    const marketSum = it.market * it.qty;
    const rcmSum = it.rcm * it.qty;
    const pvSum = it.pv * it.qty;
    const saveSum = (it.market - it.rcm) * it.qty;

    tQty += it.qty; tM += marketSum; tR += rcmSum; tPV += pvSum; tSave += saveSum;

    const div = document.createElement('div');
    div.className = 'prod-item';
    div.innerHTML = `
      <div class="prod-thumb">${ it.img ? "<img src='" + it.img + "' style='width:100%;height:100%;object-fit:cover;border-radius:6px'/>" : it.name.split(' ')[0].slice(0,2) }</div>
      <div class="prod-meta">
        <div class="title">${it.name}</div>
        <div class="sub">PV: ${it.pv} | Market: ‚Çπ${it.market} | RCM: ‚Çπ${it.rcm}</div>
      </div>
      <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
        <div class="qty-controls">
          <button class="btn-ghost" data-i="${idx}" data-act="minus">-</button>
          <input type="number" value="${it.qty}" min="1" data-i="${idx}" class="inline-qty" style="width:70px;text-align:center;padding:8px;border-radius:6px;border:1px solid #e6eef8" />
          <button class="btn-ghost" data-i="${idx}" data-act="plus">+</button>
        </div>
        <div style="font-weight:800;color:var(--accent)">Saving: ‚Çπ${fmt(saveSum)}</div>
      </div>
    `;
    productList.appendChild(div);
  });

  // attach handlers
  document.querySelectorAll('.btn-ghost[data-act]').forEach(b=>{
    b.onclick = ()=> {
      const i = Number(b.dataset.i);
      const act = b.dataset.act;
      if(act === 'plus') order[i].qty += 1;
      else order[i].qty = Math.max(1, order[i].qty - 1);
      saveOrder(); recalc(); showToast('Updated ‚úì');
    };
  });
  document.querySelectorAll('.inline-qty').forEach(inp=>{
    inp.onchange = ()=> {
      const i = Number(inp.dataset.i);
      order[i].qty = Math.max(1, parseInt(inp.value) || 1);
      saveOrder(); recalc(); showToast('Updated ‚úì');
    };
  });
  // remove buttons (last button in the qty-controls block)
  document.querySelectorAll('.prod-item .btn-ghost').forEach((b, idx)=>{
    // the remove button is the 3rd .btn-ghost in each item? We'll add remove via context menu instead:
  });

  // totals
  totalQty.innerText = tQty;
  totalMarket.innerText = "‚Çπ" + fmt(tM);
  totalRCM.innerText = "‚Çπ" + fmt(tR);
  totalPV.innerText = fmt(tPV);
  totalSaving.innerText = "‚Çπ" + fmt(tSave);

  // consistency calculation (same logic)
  let cons = 0;
  if(tPV < 1500) cons = tPV * 0.12;
  else if(tPV < 2500) cons = 1500 * 0.1667;
  else cons = 5000 * 0.1667;

  cardCons.innerText = "‚Çπ" + fmt(cons);
  const combined = tSave + cons;
  cardMonthly.innerText = "‚Çπ" + fmt(combined);
  cardAnnual.innerText = "‚Çπ" + fmt(combined * 12);
  cardTwenty.innerText = "‚Çπ" + fmt(combined * 12 * 20);

  finalBenefit.innerText = "‚Çπ" + fmt(combined);
  consPercent.innerText = (tPV > 0 ? Math.round((cons / (tPV+0.0001)) * 100) + '%' : '0%');

  // Save totals if needed
}

/* ---------- Remove item via long press or 
