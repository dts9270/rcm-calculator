<!doctype html>
<html lang="mr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>DS WORLD - RCM PRO MAX (Dual Mode)</title>

<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
/* LIGHT MODE VARIABLES */
:root{
  --primary:#0a5b99;
  --accent:#0ea44a;
  --muted:#6b7280;

  --bg: linear-gradient(180deg,#dff1ff,#e7edff,#ece3ff);
  --text:#0f1724;

  --card-bg: rgba(255,255,255,0.55);
  --card-blur: blur(18px);
  --card-border: rgba(255,255,255,0.38);
  --shadow: 0 10px 30px rgba(15,40,80,0.18);
}

/* DARK MODE VARIABLES */
.dark{
  --bg: linear-gradient(180deg,#0c1016,#05060a);
  --text:#e7ebf2;

  --primary:#4fa7ff;
  --accent:#00ff99;

  --card-bg: rgba(30,35,42,0.55);
  --card-border: rgba(88,108,146,0.32);
}

/* BODY */
body{
  margin:0;
  font-family:"Poppins",sans-serif;
  background:var(--bg);
  color:var(--text);
  transition:0.25s ease;
}

/* WRAP */
.wrap{
  max-width:1150px;
  margin:18px auto;
  padding:18px;
}

/* HEADER */
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
}
.brand{
  display:flex;align-items:center;gap:12px;
}
.logo{
  width:62px;height:62px;
  background:#fff;border-radius:14px;
  overflow:hidden;
  display:flex;justify-content:center;align-items:center;
  box-shadow:0 6px 20px rgba(0,0,0,0.15);
}
.logo img{width:100%;height:100%;object-fit:contain}

h1{
  margin:0;
  font-family:"Baloo 2";
  color:var(--primary);
}
.now{font-size:13px;color:var(--muted)}
.ds-badge{
  padding:8px 14px;
  background:linear-gradient(90deg,var(--primary),#008cff);
  border-radius:999px;
  font-weight:700;color:#fff;
}

/* TOGGLE */
#themeToggle{
  padding:10px 16px;border:none;
  border-radius:40px;
  font-weight:700;
  background:linear-gradient(135deg,#0095ff,#006bd6);
  color:#fff;
  cursor:pointer;
  box-shadow:0 8px 20px rgba(0,0,0,0.22);
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:1fr 360px;
  gap:16px;
}
@media(max-width:900px){
  .grid{grid-template-columns:1fr}
}

/* CARD (GLASS) */
.card{
  backdrop-filter:var(--card-blur);
  background:var(--card-bg);
  border:1px solid var(--card-border);
  border-radius:16px;
  padding:16px;
  box-shadow:var(--shadow);
}

/* FIELDS */
.row{display:flex;flex-wrap:wrap;gap:12px}
.field{flex:1}
label{font-size:13px;color:var(--muted)}

input,select{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid var(--card-border);
  background:rgba(255,255,255,0.45);
  color:var(--text);
}

#productList{
  max-height:380px;
  overflow:auto;
  margin-top:12px;
  padding-right:6px;
}

/* PRODUCT ITEM */
.prod-item{
  display:flex;
  justify-content:space-between;
  gap:12px;
  padding:14px;
  border-radius:14px;
  margin-bottom:12px;
  background:rgba(255,255,255,0.45);
  border:1px solid var(--card-border);
  backdrop-filter:var(--card-blur);
}
.title{font-weight:700;color:var(--primary)}
.sub{font-size:13px;color:var(--muted)}
.qty-controls{display:flex;gap:8px;align-items:center}
.btn-ghost{
  padding:6px 12px;
  border-radius:8px;
  border:1px solid var(--card-border);
  background:rgba(255,255,255,0.6);
  font-weight:700;
  color:var(--primary);
}

/* ADD BUTTON */
.btn-add{
  background:linear-gradient(90deg,var(--primary),#006fbd);
  padding:12px 16px;border:none;
  color:white;border-radius:10px;font-weight:700;
}

/* SUMMARY */
.summary{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;margin-top:12px;
}
.sum-box{
  border-radius:14px;
  text-align:center;
  padding:12px;
  background:rgba(255,255,255,0.5);
  border:1px solid var(--card-border);
  font-weight:700;
}

/* BIG CARDS */
.cards{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
@media(max-width:480px){.cards{grid-template-columns:1fr}}

.big-card{
  padding:20px;border-radius:18px;color:#fff;min-height:120px;
  position:relative;
}
.big-card .label{font-size:13px}
.big-card .val{font-size:32px;font-weight:800}

/* COLOR CARDS */
.card-saving{background:linear-gradient(135deg,#32cc7f,#0ea44a)}
.card-cons{background:linear-gradient(135deg,#9f59ff,#6d3be8)}
.card-year{background:linear-gradient(135deg,#0099ff,#006fe1)}
.card-life{background:linear-gradient(135deg,#ffb65e,#ff8a00)}

/* BUTTONS */
.ios-btn{
  width:100%;padding:14px;margin-bottom:12px;
  border:none;border-radius:28px;font-weight:700;color:#fff
}
.ios-wa{background:#1bd741}
.ios-img{background:#4890ff}
.ios-pdf{background:#ff7a1c}
.ios-clear{background:#ff4a4a}

/* FLOAT BUTTON */
.floating-add{
  position:fixed;right:20px;bottom:20px;
  width:64px;height:64px;border-radius:50%;
  border:none;color:#fff;font-size:36px;
  background:linear-gradient(135deg,var(--primary),#006fbd);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 12px 28px rgba(0,0,0,0.22);
  z-index:999;
}

/* FOOTER */
footer{text-align:center;margin-top:16px;color:var(--muted);font-weight:700}

/* SPLASH */
#splash{
  position:fixed;left:0;top:0;width:100%;height:100%;
  background:linear-gradient(135deg,#ffffff,#eaf6ff);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  z-index:2000;
}
</style>
</head>

<body>

<!-- SPLASH -->
<div id="splash">
  <div class="logo"><img src="logo.png"></div>
  <h3 style="font-family:'Baloo 2';margin-top:12px;color:#0a5b99">DS WORLD ‚Äî RCM PRO MAX</h3>
</div>

<script>
setTimeout(()=>{ 
  splash.style.display="none";
  app.style.display="block";
},1200);
</script>

<div class="wrap" id="app" style="display:none">

<header>
  <div class="brand">
    <div class="logo"><img src="logo.png"></div>
    <div>
      <h1>RCM ‡§¨‡§ö‡§§ ‡§ï‡•Ö‡§≤‡•ç‡§ï‡•ç‡§Ø‡•Å‡§≤‡•á‡§ü‡§∞ (Pro Max)</h1>
      <div class="now" id="nowDate"></div>
    </div>
  </div>

  <div style="display:flex;gap:12px">
    <button id="themeToggle">üåô DARK</button>
    <div class="ds-badge">‚ú® DS WORLD</div>
  </div>
</header>

<div class="grid">

<!-- LEFT SIDE -->
<div class="card">

  <div class="row">
    <div class="field">
      <label>‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§ö‡•á ‡§®‡§æ‡§µ</label>
      <input id="custName">
    </div>
    <div class="field">
      <label>RCM ID</label>
      <input id="rcmId">
    </div>
    <div class="field">
      <label>‡§§‡§æ‡§∞‡•Ä‡§ñ</label>
      <input id="orderDate" type="date">
    </div>
  </div>

  <h3 style="margin-top:18px;color:var(--primary)">‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§ç‡§° ‡§ï‡§∞‡§æ</h3>

  <div class="row" style="margin-top:10px">
    <select id="productSelect" style="flex:1">
      <option value="">-- Select Product --</option>
    </select>
    <input id="qtyInput" type="number" value="1" min="1" style="width:90px">
    <button id="addBtn" class="btn-add">+ ADD</button>
  </div>

  <div id="productList"></div>

  <div class="summary">
    <div class="sum-box" id="totalQty">Qty: 0</div>
    <div class="sum-box" id="totalMarket">Market: 0</div>
    <div class="sum-box" id="totalRCM">RCM: 0</div>
    <div class="sum-box" id="totalPV">PV: 0</div>
  </div>

</div>

<!-- RIGHT SIDE -->
<div>

  <div class="cards">

    <div class="big-card card-saving">
      <div class="label">üí∞ ‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
      <div class="val" id="cardMonthly">‚Çπ0</div>
    </div>

    <div class="big-card card-cons">
      <div class="label">üéØ Consistency</div>
      <div class="val" id="cardCons">‚Çπ0</div>
    </div>

    <div class="big-card card-year">
      <div class="label">üìÖ ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
      <div class="val" id="cardAnnual">‚Çπ0</div>
    </div>

    <div class="big-card card-life">
      <div class="label">üèÜ 20 ‡§µ‡§∞‡•ç‡§∑‡§æ‡§Ç‡§ö‡§æ ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
      <div class="val" id="cardTwenty">‚Çπ0</div>
    </div>

  </div>

  <div class="card" style="margin-top:14px">
    <button id="waBtn" class="ios-btn ios-wa">üì≤ WhatsApp</button>
    <button id="imgBtn" class="ios-btn ios-img">üñº Image</button>
    <button id="pdfBtn" class="ios-btn ios-pdf">üìÑ PDF</button>
    <button id="clearBtn" class="ios-btn ios-clear">üóë Clear</button>
  </div>

</div>

</div>

<footer>Designed by DS WORLD üåç | 7020970727</footer>

</div>

<button class="floating-add" id="floatAdd">+</button>

<!-- LIBRARIES -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

<script>

/* THEME TOGGLE */
themeToggle.onclick=()=>{
  document.body.classList.toggle("dark");
  themeToggle.textContent = 
    document.body.classList.contains("dark") ? "‚òÄÔ∏è LIGHT" : "üåô DARK";
};

/* TIME */
setInterval(()=>{
  nowDate.innerText =
    new Date().toLocaleString("mr-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});
},1000);
orderDate.valueAsDate = new Date();

/* PRODUCT LOAD */
let products=[];
let order=[];
const SHEET_URL="https://docs.google.com/spreadsheets/d/1eR5THz-4AV3HkfnNJ5Un48ksz0I0jrepJSED3qHFg6k/gviz/tq?tqx=out:json";

function fmt(n){return Math.round(n).toLocaleString("en-IN")}

async function loadProducts(){
  try{
    let r=await fetch(SHEET_URL);
    let t=await r.text();
    let j=JSON.parse(t.substring(47,t.length-2));
    products=j.table.rows.map(r=>({
      name:r.c[0]?.v || "",
      market:+r.c[1]?.v || 0,
      rcm:+r.c[2]?.v || 0,
      pv:+r.c[3]?.v || 0
    }));
  }catch(e){
    products=[
      {name:"‡§ü‡§æ‡§ü‡§æ ‡§Æ‡•Ä‡§† 1 ‡§ï‡§ø‡§≤‡•ã",market:30,rcm:20,pv:7},
      {name:"‡§∞‡•á‡§° ‡§≤‡•á‡§¨‡§≤ ‡§ö‡§π‡§æ 500g",market:310,rcm:240,pv:120},
    ];
  }

  products.forEach((p,i)=>{
    let o=document.createElement("option");
    o.value=i;o.textContent=p.name;
    productSelect.appendChild(o);
  });
}
loadProducts();

/* ADD PRODUCT */
addBtn.onclick=()=>{
  let idx=productSelect.value;
  if(idx==="") return alert("Product ‡§®‡§ø‡§µ‡§°‡§æ!");

  let qty=Math.max(1,parseInt(qtyInput.value)||1);
  let p=products[idx];

  let ex=order.find(o=>o.name===p.name);
  if(ex) ex.qty+=qty;
  else order.push({...p,qty});

  calc();
};

/* FLOAT BUTTON */
floatAdd.onclick=()=>addBtn.click();

/* CALCULATE */
function calc(){
  productList.innerHTML="";
  let tQ=0,tM=0,tR=0,tPV=0,tSave=0;

  order.forEach((it,i)=>{
    let m=it.market*it.qty;
    let r=it.rcm*it.qty;
    let pv=it.pv*it.qty;
    let s=(it.market-it.rcm)*it.qty;

    tQ+=it.qty; tM+=m; tR+=r; tPV+=pv; tSave+=s;

    let div=document.createElement("div");
    div.className="prod-item";
    div.innerHTML=`
      <div style="flex:1">
        <div class="title">${it.name}</div>
        <div class="sub">PV: ${it.pv} | M: ‚Çπ${it.market} | RCM: ‚Çπ${it.rcm}</div>
      </div>
      <div style="text-align:right">
        <div class="qty-controls">
          <button class="btn-ghost" data-i="${i}" data-a="minus">-</button>
          <input type="number" class="inline-qty" data-i="${i}" value="${it.qty}" min="1" style="width:60px;text-align:center">
          <button class="btn-ghost" data-i="${i}" data-a="plus">+</button>
        </div>
        <div style="margin-top:6px;font-weight:700;color:var(--accent)">‚Çπ${fmt(s)}</div>
      </div>
    `;
    productList.appendChild(div);
  });

  totalQty.innerText="Qty: "+tQ;
  totalMarket.innerText="Market: ‚Çπ"+fmt(tM);
  totalRCM.innerText="RCM: ‚Çπ"+fmt(tR);
  totalPV.innerText="PV: "+fmt(tPV);

  /* CONSISTENCY */
  let cons=0;
  if(tPV<1500) cons=tPV*0.12;
  else if(tPV<2500) cons=1500*0.1667;
  else cons=5000*0.1667;

  let combined=tSave+cons;

  /* UPDATE CARDS */
  cardMonthly.innerText="‚Çπ"+fmt(combined);
  cardCons.innerText="‚Çπ"+fmt(cons);
  cardAnnual.innerText="‚Çπ"+fmt(combined*12);
  cardTwenty.innerText="‚Çπ"+fmt(combined*12*20);

  /* QTY +/- */
  document.querySelectorAll(".btn-ghost").forEach(b=>{
    b.onclick=()=>{
      let i=b.dataset.i;
      if(b.dataset.a==="plus") order[i].qty++;
      else order[i].qty=Math.max(1,order[i].qty-1);
      calc();
    };
  });

  document.querySelectorAll(".inline-qty").forEach(inp=>{
    inp.onchange=()=>{
      let i=inp.dataset.i;
      order[i].qty=Math.max(1,parseInt(inp.value)||1);
      calc();
    };
  });
}

/* CLEAR */
clearBtn.onclick=()=>{
  if(confirm("Clear ‡§ï‡§∞‡§æ‡§Ø‡§ö‡•á?")){
    order=[];calc();
  }
};

/* WHATSAPP SHARE */
waBtn.onclick=()=>{
  let msg="*RCM Summary*\n";
  order.forEach((it,i)=> msg+=`\n${i+1}. ${it.name} - ${it.qty}`);
  msg+=`\n\nPV: ${totalPV.innerText}`;
  msg+=`\nBenefit: ${cardMonthly.innerText}`;
  window.open("https://wa.me/?text="+encodeURIComponent(msg));
};

/* IMAGE */
imgBtn.onclick=()=>{
  html2canvas(document.querySelector(".wrap")).then(c=>{
    const a=document.createElement("a");
    a.href=c.toDataURL();
    a.download="RCM_Order.png";a.click();
  });
};

/* PDF */
pdfBtn.onclick=()=>{
  html2pdf().from(document.querySelector(".wrap")).save("RCM_Invoice.pdf");
};
</script>

</body>
</html>
