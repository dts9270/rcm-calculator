<!doctype html>
<html lang="mr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>DS WORLD ‚Äì RCM ‡§¨‡§ö‡§§</title>

<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
/* ====== VARIABLES ====== */
:root{
  --primary:#0a5b99;
  --accent:#0ea44a;
  --bg:linear-gradient(180deg,#dff1ff,#e7edff,#ece3ff);
  --text:#0f1724;
  --card-bg:rgba(255,255,255,0.55);
  --card-blur:blur(18px);
  --card-border:rgba(255,255,255,0.33);
}
.dark{
  --primary:#4fa7ff;
  --accent:#00ff99;
  --bg:linear-gradient(180deg,#07090d,#0d1117);
  --text:#eaf1ff;
  --card-bg:rgba(40,40,45,0.45);
  --card-border:rgba(88,108,146,0.33);
}

/* ====== GLOBAL ====== */
body{
  margin:0;
  font-family:Poppins,system-ui;
  background:var(--bg);
  color:var(--text);
  transition:0.4s ease;
}
.wrap{
  max-width:1150px;
  margin:16px auto;
  padding:16px;
}

/* ====== SPLASH ====== */
#splash{
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:#ffffff;
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  z-index:5000;
}
#splash img{width:90px;height:90px;margin-bottom:14px}

/* ====== HEADER ====== */
header{
  display:flex;justify-content:space-between;align-items:center;
}
.brand{display:flex;gap:12px;align-items:center}
.logo{
  width:62px;height:62px;border-radius:14px;overflow:hidden;
  background:#fff;box-shadow:0 6px 20px rgba(0,0,0,0.18);
}
.logo img{width:100%;height:100%}
h1{font-family:'Baloo 2';margin:0;color:var(--primary)}
.now{font-size:13px;opacity:0.7}
#themeToggle{
  padding:10px 16px;border:none;border-radius:20px;
  background:linear-gradient(90deg,#0095ff,#006bd6);
  color:#fff;font-weight:700;cursor:pointer;
}

/* ====== GRID ====== */
.grid{
  display:grid;grid-template-columns:1fr 350px;gap:16px;
}
@media(max-width:900px){ .grid{grid-template-columns:1fr} }

/* ====== CARD ====== */
.card{
  background:var(--card-bg);
  backdrop-filter:var(--card-blur);
  border:1px solid var(--card-border);
  border-radius:16px;
  padding:16px;
  box-shadow:0 6px 18px rgba(0,0,0,0.12);
}

/* ====== PRODUCT LIST ====== */
.prod-item{
  display:flex;justify-content:space-between;
  gap:12px;padding:12px;margin-bottom:12px;
  background:rgba(255,255,255,0.45);
  border-radius:12px;
}
.qty-btn{padding:4px 10px;border-radius:8px;border:none;background:#dde7ff}

/* ====== TOTAL BOX ====== */
.sum-box{
  text-align:center;padding:12px;border-radius:12px;
  background:rgba(255,255,255,0.45);font-weight:700;
}

/* ====== BIG CARDS ====== */
.big-card{
  padding:18px;border-radius:16px;color:#fff;min-height:110px;
}
.big-card .label{font-size:13px}
.big-card .val{font-size:32px;font-weight:800}

.card-saving{background:linear-gradient(135deg,#32cc7f,#0ea44a)}
.card-cons{background:linear-gradient(135deg,#9f59ff,#6d3be8)}
.card-year{background:linear-gradient(135deg,#0099ff,#006fe1)}
.card-life{background:linear-gradient(135deg,#ffb65e,#ff8a00)}

/* ====== FLOATING ADD ====== */
.floating-add{
  position:fixed;right:20px;bottom:20px;
  width:60px;height:60px;border-radius:50%;
  background:linear-gradient(135deg,var(--primary),#006fbd);
  color:#fff;font-size:32px;display:flex;
  align-items:center;justify-content:center;
  box-shadow:0 12px 28px rgba(0,0,0,0.22);
  z-index:999;
}

/* ====== VISITOR DASHBOARD ====== */
#visitorBox span{
  font-family:'Baloo 2';
  font-size:20px;font-weight:700;color:var(--accent);
}
#visitorWelcome{
  position:fixed;bottom:20px;left:50%;
  transform:translateX(-50%);
  padding:10px 18px;background:#fff;color:#333;
  font-weight:700;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,0.2);
  display:none;z-index:4000;
}
</style>
</head>

<body>

<!-- SPLASH -->
<div id="splash">
  <img src="logo.png">
  <h3 style="margin:0;font-family:'Baloo 2';color:#0a5b99">
    DS WORLD ‚Äì RCM ‡§¨‡§ö‡§§
  </h3>
</div>

<script>
setTimeout(()=>{ 
  document.getElementById("splash").style.display="none";
  document.getElementById("app").style.display="block";
},1200);
</script>
<!-- MAIN APP -->
<div class="wrap" id="app" style="display:none">

<header>
  <div class="brand">
    <div class="logo"><img src="logo.png"></div>
    <div>
      <h1>RCM ‡§¨‡§ö‡§§</h1>
      <div class="now" id="nowDate"></div>
    </div>
  </div>

  <button id="themeToggle">üåô DARK</button>
</header>


<!-- GRID LAYOUT -->
<div class="grid">

  <!-- LEFT SIDE -->
  <div class="card">

    <!-- INFO FORM -->
    <div class="row" style="display:flex;gap:10px;flex-wrap:wrap">
      <div style="flex:1">
        <label>‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§ö‡•á ‡§®‡§æ‡§µ</label>
        <input id="custName" placeholder="‡§®‡§æ‡§µ ‡§ü‡§æ‡§ï‡§æ">
      </div>
      <div style="flex:1">
        <label>RCM ID</label>
        <input id="rcmId" placeholder="RCM ID">
      </div>
      <div style="flex:1">
        <label>‡§§‡§æ‡§∞‡•Ä‡§ñ</label>
        <input id="orderDate" type="date">
      </div>
    </div>

    <h3 style="margin-top:16px;color:var(--primary)">‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§ç‡§° ‡§ï‡§∞‡§æ</h3>

    <div class="row" style="display:flex;gap:10px;margin-top:10px">
      <select id="productSelect" style="flex:1;padding:10px">
        <option value="">-- ‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§®‡§ø‡§µ‡§°‡§æ --</option>
      </select>

      <input id="qtyInput" type="number" value="1" min="1"
        style="width:80px;padding:10px;text-align:center">

      <button id="addBtn" class="btn-add"
        style="background:var(--primary);color:#fff;padding:10px 16px;border:none;border-radius:10px;font-weight:700">
        + ADD
      </button>
    </div>


    <!-- PRODUCT LIST -->
    <div id="productList" style="margin-top:16px"></div>


    <!-- LIVE TOTALS BELOW THE PRODUCT LIST -->
    <div id="liveTotals" style="margin-top:14px;font-size:15px;line-height:22px;font-weight:600">
      <div>üßæ ‡§è‡§ï‡•Ç‡§£ ‡§Æ‡§æ‡§∞‡•ç‡§ï‡•á‡§ü ‡§ï‡§ø‡§Ç‡§Æ‡§§: <span id="ltMarket">‚Çπ0</span></div>
      <div>üè∑ ‡§è‡§ï‡•Ç‡§£ RCM ‡§ï‡§ø‡§Ç‡§Æ‡§§: <span id="ltRCM">‚Çπ0</span></div>
      <div>üí∏ ‡§è‡§ï‡•Ç‡§£ ‡§¨‡§ö‡§§: <span id="ltSave">‚Çπ0</span></div>
    </div>


    <!-- SUMMARY BOXES -->
    <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:14px">
      <div class="sum-box" id="totalQty">Qty: 0</div>
      <div class="sum-box" id="totalMarket">Market: ‚Çπ0</div>
      <div class="sum-box" id="totalRCM">RCM: ‚Çπ0</div>
      <div class="sum-box" id="totalPV">PV: 0</div>
    </div>

  </div>



  <!-- RIGHT SIDE -->
  <div>

    <!-- SAVING CARDS -->
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">

      <div class="big-card card-saving">
        <div class="label">üí∞ ‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
        <div class="val" id="cardMonthly">‚Çπ0</div>
      </div>

      <div class="big-card card-cons">
        <div class="label">üéØ Consistency</div>
        <div class="val" id="cardCons">‚Çπ0</div>
      </div>

      <div class="big-card card-year">
        <div class="label">üìÖ ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
        <div class="val" id="cardAnnual">‚Çπ0</div>
      </div>

      <div class="big-card card-life">
        <div class="label">üèÜ 20 ‡§µ‡§∞‡•ç‡§∑‡§æ‡§Ç‡§ö‡§æ ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
        <div class="val" id="cardTwenty">‚Çπ0</div>
      </div>

    </div>


    <!-- ACTION BUTTONS -->
    <div class="card" style="margin-top:16px">
      <button id="waBtn" class="ios-btn ios-wa" style="background:#1bd741;width:100%;padding:14px;border:none;border-radius:25px;color:#fff;font-weight:700;margin-bottom:10px">üì≤ WhatsApp</button>
      <button id="imgBtn" class="ios-btn ios-img" style="background:#4890ff;width:100%;padding:14px;border:none;border-radius:25px;color:#fff;font-weight:700;margin-bottom:10px">üñº Image</button>
      <button id="pdfBtn" class="ios-btn ios-pdf" style="background:#ff7a1c;width:100%;padding:14px;border:none;border-radius:25px;color:#fff;font-weight:700;margin-bottom:10px">üìÑ PDF</button>
      <button id="placeBtn" class="ios-btn" style="background:#a020f0;width:100%;padding:14px;border:none;border-radius:25px;color:#fff;font-weight:700;margin-bottom:10px">üìù Place Order</button>
      <button id="clearBtn" class="ios-btn ios-clear" style="background:#ff4a4a;width:100%;padding:14px;border:none;border-radius:25px;color:#fff;font-weight:700">üóë Clear</button>
    </div>

  </div>

</div><!-- grid end -->


<footer style="text-align:center;margin-top:14px;font-weight:700;color:var(--muted)">
  Designed by DS WORLD üåç | 7020970727
</footer>

</div><!-- app end -->



<!-- FLOAT ADD BUTTON -->
<button class="floating-add" id="floatAdd">+</button>




<!-- ORDER POPUP -->
<div id="orderPopup" style="
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.32);display:none;align-items:center;justify-content:center;z-index:3000">
    
  <div class="card" style="width:330px;max-width:90%;padding:20px">
    <h3 style="margin:0;color:var(--primary);font-family:'Baloo 2'">Place Order</h3>

    <label style="margin-top:12px">‡§®‡§æ‡§µ</label>
    <input id="p_name" placeholder="‡§®‡§æ‡§µ">

    <label style="margin-top:10px">‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤</label>
    <input id="p_mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§à‡§≤ ‡§®‡§Ç‡§¨‡§∞">

    <label style="margin-top:10px">‡§™‡§§‡•ç‡§§‡§æ</label>
    <textarea id="p_address" rows="2" placeholder="‡§™‡§§‡•ç‡§§‡§æ"></textarea>

    <button id="sendOrderBtn" class="ios-btn" style="background:#1bd741;width:100%;margin-top:14px;border:none;border-radius:24px;padding:12px;color:#fff;font-weight:700">
      üì§ Send Order
    </button>

    <button onclick="orderPopup.style.display='none'" class="ios-btn ios-clear" style="background:#ff4a4a;width:100%;margin-top:10px;border:none;border-radius:24px;padding:12px;color:#fff;font-weight:700">
      ‚úñ Close
    </button>

  </div>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

<script>
/* ------------------ THEME TOGGLE ------------------ */
themeToggle.onclick = () => {
  document.body.classList.toggle("dark");
  themeToggle.textContent = 
    document.body.classList.contains("dark") ? "‚òÄÔ∏è LIGHT" : "üåô DARK";
};


/* ------------------ DATE ------------------ */
setInterval(() => {
  nowDate.innerText = new Date().toLocaleString("mr-IN", {
    day: "2-digit", month: "short", year: "numeric",
    hour: "2-digit", minute: "2-digit"
  });
}, 1000);
orderDate.valueAsDate = new Date();


/* ------------------ GOOGLE SHEET ------------------ */
let products = [];
let order = [];

const SHEET_URL =
  "https://docs.google.com/spreadsheets/d/1eR5THz-4AV3HkfnNJ5Un48ksz0I0jrepJSED3qHFg6k/gviz/tq?tqx=out:json";

function fmt(n){ return Math.round(n).toLocaleString("en-IN"); }

async function loadProducts(){
  try{
    let r = await fetch(SHEET_URL);
    let t = await r.text();
    let j = JSON.parse(t.substring(47, t.length-2));

    products = j.table.rows.map(r=>({
      name: r.c[0]?.v || "",
      market: +r.c[1]?.v || 0,
      rcm: +r.c[2]?.v || 0,
      pv: +r.c[3]?.v || 0
    }));
  }
  catch(e){
    products = [
      {name:"‡§ü‡§æ‡§ü‡§æ ‡§Æ‡•Ä‡§† 1 ‡§ï‡§ø‡§≤‡•ã", market:30, rcm:20, pv:7},
      {name:"‡§∞‡•á‡§° ‡§≤‡•á‡§¨‡§≤ ‡§ö‡§π‡§æ 500g", market:310, rcm:240, pv:120}
    ];
  }

  products.forEach((p,i)=>{
    let o = document.createElement("option");
    o.value = i;
    o.textContent = p.name;
    productSelect.appendChild(o);
  });
}
loadProducts();


/* ------------------ ADD PRODUCT ------------------ */
addBtn.onclick = () => {
  let idx = productSelect.value;
  if(idx === "") return alert("‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§®‡§ø‡§µ‡§°‡§æ!");

  let qty = Math.max(1, parseInt(qtyInput.value) || 1);
  let p = products[idx];

  let ex = order.find(o => o.name === p.name);
  if(ex) ex.qty += qty;
  else order.push({...p, qty});

  productSelect.value = "";
  qtyInput.value = 1;

  calc();
  showConfetti();
};

/* Floating Add Button */
floatAdd.onclick = () => addBtn.click();


/* ------------------ CALCULATE ------------------ */
function calc(){
  productList.innerHTML = "";
  
  let tQ = 0, tM = 0, tR = 0, tPV = 0, tSave = 0;

  order.forEach((it, i)=>{
    let m = it.market * it.qty;
    let r = it.rcm * it.qty;
    let s = (it.market - it.rcm) * it.qty;
    let pv = it.pv * it.qty;

    tQ += it.qty; 
    tM += m; 
    tR += r; 
    tPV += pv; 
    tSave += s;

    /* PRODUCT ITEM */
    let div = document.createElement("div");
    div.className = "prod-item";
    div.innerHTML = `
      <div style="flex:1">
        <div style="font-weight:700;color:var(--primary)">${it.name}</div>
        <div style="font-size:13px;opacity:0.7">PV:${it.pv} | M:‚Çπ${it.market} | RCM:‚Çπ${it.rcm}</div>
      </div>

      <div style="text-align:right">
        <div style="display:flex;gap:6px;justify-content:flex-end">
          <button class="qty-btn" data-i="${i}" data-a="minus">-</button>
          <input class="inline-qty" data-i="${i}" type="number" min="1" value="${it.qty}"
            style="width:55px;text-align:center;padding:6px;border-radius:8px;border:1px solid #ccc">
          <button class="qty-btn" data-i="${i}" data-a="plus">+</button>
        </div>
        <div style="margin-top:6px;font-weight:700;color:var(--accent)">‚Çπ${fmt(s)}</div>
      </div>
    `;
    productList.appendChild(div);
  });


  /* LIVE TOTALS Under List */
  ltMarket.innerText = "‚Çπ" + fmt(tM);
  ltRCM.innerText = "‚Çπ" + fmt(tR);
  ltSave.innerText = "‚Çπ" + fmt(tSave);


  /* SUMMARY */
  totalQty.innerText = "Qty: " + fmt(tQ);
  totalMarket.innerText = "Market: ‚Çπ" + fmt(tM);
  totalRCM.innerText = "RCM: ‚Çπ" + fmt(tR);
  totalPV.innerText = "PV: " + fmt(tPV);


  /* CONSISTENCY */
  let cons = 0;
  if(tPV < 1500) cons = tPV * 0.12;
  else if(tPV < 2500) cons = 1500 * 0.1667;
  else cons = 5000 * 0.1667;

  let combined = tSave + cons;

  /* CARDS UPDATE */
  cardMonthly.innerText = "‚Çπ" + fmt(combined);
  cardCons.innerText = "‚Çπ" + fmt(cons);
  cardAnnual.innerText = "‚Çπ" + fmt(combined * 12);
  cardTwenty.innerText = "‚Çπ" + fmt(combined * 12 * 20);


  /* QTY +/- */
  document.querySelectorAll(".qty-btn").forEach(btn=>{
    btn.onclick = ()=>{
      let i = btn.dataset.i;
      if(btn.dataset.a === "plus") order[i].qty++;
      else order[i].qty = Math.max(1, order[i].qty - 1);
      calc();
    };
  });

  document.querySelectorAll(".inline-qty").forEach(inp=>{
    inp.onchange = ()=>{
      let i = inp.dataset.i;
      order[i].qty = Math.max(1, parseInt(inp.value)||1);
      calc();
    };
  });
}


/* ------------------ CONFETTI ------------------ */
function showConfetti(){
  const emojis = ["üéâ","‚ú®","üéä","üí•","üí∏","üî•"];
  for(let i=0;i<12;i++){
    let e = document.createElement("div");
    e.textContent = emojis[Math.floor(Math.random()*emojis.length)];
    e.style.position="fixed";
    e.style.left = Math.random()*100+"%";
    e.style.bottom="-20px";
    e.style.fontSize="28px";
    e.style.animation = "confettiUp 1.4s ease-out forwards";
    document.body.appendChild(e);
    setTimeout(()=>e.remove(),1500);
  }
}

const confettiStyle = document.createElement("style");
confettiStyle.innerHTML = `
@keyframes confettiUp {
  0%{transform:translateY(0);opacity:1}
  100%{transform:translateY(-180px);opacity:0}
}`;
document.head.appendChild(confettiStyle);


/* ------------------ CLEAR ------------------ */
clearBtn.onclick = () => {
  if(confirm("Clear ‡§ï‡§∞‡§æ‡§Ø‡§ö‡•á?")){
    order = [];
    calc();
  }
};


/* ------------------ WHATSAPP SHARE ------------------ */
waBtn.onclick = () => {
  let msg = `*RCM Order Summary*\n`;

  order.forEach((it,i)=>{
    msg += `\n${i+1}) ${it.name}  x ${it.qty}`;
  });

  msg += `\n\n*Market:* ‚Çπ${fmt(ltMarket.innerText.replace("‚Çπ",""))}`;
  msg += `\n*RCM:* ‚Çπ${fmt(ltRCM.innerText.replace("‚Çπ",""))}`;
  msg += `\n*Saving:* ‚Çπ${fmt(ltSave.innerText.replace("‚Çπ",""))}`;

  msg += `\n\n*Monthly Benefit:* ${cardMonthly.innerText}`;
  msg += `\n*Yearly:* ${cardAnnual.innerText}`;
  msg += `\n*20 Years:* ${cardTwenty.innerText}`;

  window.open("https://wa.me/?text=" + encodeURIComponent(msg));
};


/* ------------------ IMAGE DOWNLOAD ------------------ */
imgBtn.onclick = () => {
  html2canvas(document.querySelector(".wrap")).then(canvas=>{
    let a = document.createElement("a");
    a.href = canvas.toDataURL("image/png");
    a.download="RCM_Order.png";
    a.click();
  });
};


/* ------------------ PDF DOWNLOAD ------------------ */
pdfBtn.onclick = () => {
  html2pdf().from(document.querySelector(".wrap")).save("RCM_Invoice.pdf");
};


/* ------------------ PLACE ORDER POPUP ------------------ */
placeBtn.onclick = () => {
  orderPopup.style.display="flex";
};


/* ------------------ SEND ORDER ‚Üí WHATSAPP ------------------ */
sendOrderBtn.onclick = () => {
  let name = p_name.value.trim();
  let mob = p_mobile.value.trim();
  let add = p_address.value.trim();

  if(!name || !mob || !add){
    alert("‡§∏‡§∞‡•ç‡§µ ‡§´‡•Ä‡§≤‡•ç‡§° ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Ü‡§π‡•á‡§§!");
    return;
  }

  let msg = `*New Order*\n`;
  msg += `\n*Name:* ${name}`;
  msg += `\n*Mobile:* ${mob}`;
  msg += `\n*Address:* ${add}`;
  msg += `\n\n*Items:*`;

  order.forEach((it,i)=>{
    msg += `\n${i+1}) ${it.name} x ${it.qty}`;
  });

  msg += `\n\n*Total Saving:* ${ltSave.innerText}`;

  window.open("https://wa.me/7020970727?text=" + encodeURIComponent(msg));

  orderPopup.style.display="none";
};


/* ------------------ VISITORS PRO COUNTER ------------------ */
function visitors(){
  let total = localStorage.getItem("vis_total") || 0;
  let today = localStorage.getItem("vis_today") || 0;
  let last = localStorage.getItem("vis_date");

  let now = new Date().toDateString();

  if(last !== now){
    today = 0;
    localStorage.setItem("vis_date", now);
  }

  total++;
  today++;

  localStorage.setItem("vis_total", total);
  localStorage.setItem("vis_today", today);

  if(document.getElementById("visitorBox")){
    document.getElementById("visitorBox").innerHTML = `
      Total Visitors: <span>${total}</span><br>
      Today: <span>${today}</span>
    `;
  }

  visitorWelcome.innerText = "Welcome Back!";
  visitorWelcome.style.display="block";
  setTimeout(()=>visitorWelcome.style.display="none",1600);
}
visitors();
</script>
