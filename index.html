<!DOCTYPE html>
<html lang="mr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DS WORLD ‚Äì RCM PRO MAX</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>

/* LIGHT MODE */
:root{
  --primary:#0a5b99;
  --accent:#0ea44a;
  --muted:#6b7280;

  --bg:linear-gradient(180deg,#dff1ff,#e7edff,#ece3ff);
  --text:#0f1724;

  --card-bg:rgba(255,255,255,0.55);
  --card-blur:blur(18px);
  --card-border:rgba(255,255,255,0.38);

  --box-shadow:0 6px 24px rgba(0,0,0,0.12);
}

/* DARK MODE */
.dark{
  --bg:linear-gradient(180deg,#0c1016,#05060a);
  --text:#e7ebf2;
  --primary:#4fa7ff;
  --accent:#00ff99;
  --card-bg:rgba(30,35,42,0.55);
  --card-border:rgba(88,108,146,0.32);
}

body{
  margin:0;
  font-family:"Poppins",sans-serif;
  background:var(--bg);
  color:var(--text);
  transition:0.2s ease;
}

/* MAIN WRAP */
.wrap{
  max-width:1180px;
  margin:18px auto;
  padding:18px;
}

/* HEADER */
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.brand{
  display:flex;
  align-items:center;
  gap:16px;
}

.logo{
  width:62px;height:62px;
  border-radius:16px;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
  background:#fff;
  box-shadow:var(--box-shadow);
}

h1{
  margin:0;
  font-family:"Baloo 2";
  color:var(--primary);
}

.now{font-size:13px;color:var(--muted)}

#themeToggle{
  padding:10px 18px;
  border:none;
  border-radius:30px;
  background:linear-gradient(135deg,#0095ff,#006fbd);
  color:#fff;
  font-weight:700;
  cursor:pointer;
}

/* GRID BOX */
.grid{
  display:grid;
  grid-template-columns:1fr 360px;
  gap:18px;
}
@media(max-width:900px){
  .grid{
    grid-template-columns:1fr;
  }
}

/* CARD (GLASS EFFECT) */
.card{
  background:var(--card-bg);
  border:1px solid var(--card-border);
  backdrop-filter:var(--card-blur);
  border-radius:18px;
  padding:18px;
  box-shadow:var(--box-shadow);
}

/* INPUTS */
input,select{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid var(--card-border);
  background:rgba(255,255,255,0.5);
  font-size:15px;
}

/* PRODUCT ITEM */
.product-item{
  display:flex;
  justify-content:space-between;
  margin-bottom:12px;
  padding:12px;
  background:rgba(255,255,255,0.45);
  border-radius:16px;
  border:1px solid var(--card-border);
}
.product-title{font-weight:700;color:var(--primary)}
.product-meta{font-size:13px;color:var(--muted)}

.qty-controls{
  display:flex;
  gap:6px;
}

.btn-ghost{
  padding:6px 12px;
  background:#fff2;
  border:1px solid var(--card-border);
  border-radius:8px;
  font-weight:700;
}

/* BIG BENEFIT CARDS */
.big-card{
  padding:22px;
  border-radius:20px;
  color:#fff;
  text-align:center;                     /* CENTER FIX */
  display:flex;                           /* CENTER FIX */
  flex-direction:column;                  /* CENTER FIX */
  align-items:center;                     /* CENTER FIX */
  justify-content:center;                 /* CENTER FIX */
  min-height:140px;
}

/* Premium Fonts (Attractive) */
.big-card .label{
  font-size:16px;
  font-weight:600;
  opacity:0.9;
  letter-spacing:0.5px;
}

.big-card .val{
  margin-top:8px;
  font-size:36px;
  font-weight:800;
  font-family:"Baloo 2";     /* Attractive Marathi/English Mix */
}

/* CARD COLORS */
.card-saving{background:linear-gradient(135deg,#32cc7f,#0ea44a)}
.card-cons{background:linear-gradient(135deg,#9f59ff,#6d3be8)}
.card-year{background:linear-gradient(135deg,#0099ff,#006fe1)}
.card-life{background:linear-gradient(135deg,#ff9d42,#ff7b00)}

/* ACTION BUTTONS */
.ios-btn{
  width:100%;
  padding:14px;
  border-radius:30px;
  font-weight:700;
  border:none;
  margin-bottom:12px;
  color:#fff;
}
.ios-wa{background:#1bd741}
.ios-img{background:#4890ff}
.ios-pdf{background:#ff7a1c}
.ios-clear{background:#ff4a4a}

/* FLOAT BUTTON */
.floating-add{
  position:fixed;
  right:20px;
  bottom:20px;
  width:60px;
  height:60px;
  border-radius:50%;
  background:linear-gradient(135deg,var(--primary),#006fbd);
  border:none;
  color:#fff;
  font-size:34px;
  font-weight:700;
  display:flex;
  justify-content:center;
  align-items:center;
  box-shadow:0 8px 20px rgba(0,0,0,0.25);
  z-index:999;
}

/* POPUP */
#orderPopup{
  position:fixed;
  left:0;top:0;
  width:100%;height:100%;
  background:rgba(0,0,0,0.45);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:999;
}

</style>
</head>
<body>

<div class="wrap">
<header>
  <div class="brand">
    <div class="logo"><img src="logo.png" style="width:100%;height:100%;object-fit:contain;"></div>
    <div>
      <h1>RCM ‡§¨‡§ö‡§§ ‡§ï‡•Ö‡§≤‡•ç‡§ï‡•ç‡§Ø‡•Å‡§≤‡•á‡§ü‡§∞ (Pro Max)</h1>
      <div class="now" id="nowDate"></div>
    </div>
  </div>

  <button id="themeToggle">üåô DARK</button>
</header>

<div class="grid">

<!-- LEFT SECTION -->
<div class="card">

  <div class="row" style="display:flex;flex-wrap:wrap;gap:12px">
    <div style="flex:1">
      <label>‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§ö‡•á ‡§®‡§æ‡§µ</label>
      <input id="custName" placeholder="‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§ö‡•á ‡§®‡§æ‡§µ">
    </div>

    <div style="flex:1">
      <label>RCM ID / AB ID</label>
      <input id="rcmId" placeholder="RCM ID">
    </div>

    <div style="flex:1">
      <label>‡§§‡§æ‡§∞‡•Ä‡§ñ</label>
      <input id="orderDate" type="date">
    </div>
  </div>

  <h3 style="margin-top:20px;color:var(--primary)">‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§ç‡§° ‡§ï‡§∞‡§æ</h3>

  <div class="row" style="margin-top:10px;display:flex;gap:10px">
    <select id="productSelect" style="flex:1">
      <option value="">-- ‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§®‡§ø‡§µ‡§°‡§æ --</option>
    </select>

    <input type="number" id="qtyInput" value="1" min="1" style="width:80px;text-align:center">

    <button id="addBtn" class="btn-add">+ Add</button>
  </div>

  <div id="productList" style="margin-top:16px;max-height:380px;overflow:auto;"></div>

  <div class="summary">
    <div class="sum-box" id="totalQty">Qty: 0</div>
    <div class="sum-box" id="totalMarket">Market: 0</div>
    <div class="sum-box" id="totalRCM">RCM: 0</div>
    <div class="sum-box" id="totalPV">PV: 0</div>
  </div>

</div>

<!-- RIGHT SECTION -->
<div>

  <div class="cards">

    <div class="big-card card-saving">
      <div class="label">üí∞ ‡§Æ‡§æ‡§∏‡§ø‡§ï ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
      <div class="val" id="cardMonthly">‚Çπ0</div>
    </div>

    <div class="big-card card-cons">
      <div class="label">üéØ Consistency</div>
      <div class="val" id="cardCons">‚Çπ0</div>
    </div>

    <div class="big-card card-year">
      <div class="label">üìÖ ‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
      <div class="val" id="cardAnnual">‚Çπ0</div>
    </div>

    <div class="big-card card-life">
      <div class="label">üèÜ 20 ‡§µ‡§∞‡•ç‡§∑‡§æ‡§Ç‡§ö‡§æ ‡§´‡§æ‡§Ø‡§¶‡§æ</div>
      <div class="val" id="cardTwenty">‚Çπ0</div>
    </div>

  </div>

  <div class="card" style="margin-top:16px">
    <button id="waBtn" class="ios-btn ios-wa">üì≤ WhatsApp</button>
    <button id="imgBtn" class="ios-btn ios-img">üñº Image</button>
    <button id="pdfBtn" class="ios-btn ios-pdf">üìÑ PDF</button>
    <button id="placeOrderBtn" class="ios-btn ios-img" style="background:#6c5ce7">üìù Place Order</button>
    <button id="clearBtn" class="ios-btn ios-clear">üóë Clear</button>
  </div>

</div>

</div>

<footer style="text-align:center;margin-top:22px;font-weight:700;color:var(--muted);">
  Designed By DS WORLD üåç | 7020970727
</footer>

<button class="floating-add" id="floatAdd">+</button>

<!-- POPUP FOR PLACE ORDER -->
<div id="orderPopup">
  <div style="background:#fff;padding:22px;border-radius:16px;width:90%;max-width:360px;">
    <h3 style="margin:0 0 10px 0;color:#333">Place Order</h3>

    <label>‡§®‡§æ‡§µ</label>
    <input id="p_name" style="margin-bottom:10px">

    <label>Mobile</label>
    <input id="p_mobile" style="margin-bottom:10px">

    <label>Address</label>
    <input id="p_address" style="margin-bottom:16px">

    <button id="sendOrderBtn" class="ios-btn ios-wa">Send to WhatsApp</button>
    <button id="closePopup" class="ios-btn ios-clear" style="margin-top:8px">Close</button>
  </div>
</div>
<!-- LIBRARIES -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

<script>
/* SHORTCUT */
function $(id){ return document.getElementById(id); }

/* THEME TOGGLE */
themeToggle.onclick = () => {
  document.body.classList.toggle("dark");
  themeToggle.textContent = 
    document.body.classList.contains("dark") ? "‚òÄÔ∏è LIGHT" : "üåô DARK";
};

/* DATE AUTO */
orderDate.valueAsDate = new Date();
setInterval(()=>{
  nowDate.innerText =
    new Date().toLocaleString("mr-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});
},1000);

/* LOAD PRODUCTS FROM GOOGLE SHEET */
let products = [];
const SHEET_URL =
"https://docs.google.com/spreadsheets/d/1eR5THz-4AV3HkfnNJ5Un48ksz0I0jrepJSED3qHFg6k/gviz/tq?tqx=out:json";

async function loadProducts(){
  try{
    let r=await fetch(SHEET_URL);
    let t=await r.text();
    let j=JSON.parse(t.substring(47, t.length-2));

    products = j.table.rows.map(r=>({
      name: r.c[0]?.v || "",
      market: Number(r.c[1]?.v || 0),
      rcm: Number(r.c[2]?.v || 0),
      pv: Number(r.c[3]?.v || 0)
    }));

  }catch(e){
    products = [
      {name:"‡§ü‡§æ‡§ü‡§æ ‡§Æ‡•Ä‡§† 1 ‡§ï‡§ø‡§≤‡•ã", market:30, rcm:20, pv:7},
      {name:"‡§∞‡•á‡§° ‡§≤‡•á‡§¨‡§≤ ‡§ö‡§π‡§æ 500g", market:310, rcm:240, pv:120},
    ];
  }

  products.forEach((p,i)=>{
    const o=document.createElement("option");
    o.value=i;
    o.textContent=p.name;
    productSelect.appendChild(o);
  });
}
loadProducts();

/* ORDER DATA */
let order=[];

function fmt(n){ return Math.round(n).toLocaleString("en-IN"); }

/* ADD PRODUCT */
addBtn.onclick = () => {
  if(productSelect.value === ""){ alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•ç‡§∞‡•â‡§°‡§ï‡•ç‡§ü ‡§®‡§ø‡§µ‡§°‡§æ"); return; }

  let p = products[productSelect.value];
  let qty = Math.max(1, parseInt(qtyInput.value)||1);

  let ex = order.find(o=>o.name===p.name);
  if(ex) ex.qty += qty;
  else order.push({...p, qty});

  calc();
};

/* FLOAT BUTTON */
floatAdd.onclick = ()=> addBtn.click();

/* CALCULATE & RENDER */
function calc(){
  productList.innerHTML="";
  let tQ=0, tM=0, tR=0, tPV=0, tSave=0;

  order.forEach((it,i)=>{
    let m=it.market*it.qty;
    let r=it.rcm*it.qty;
    let pv=it.pv*it.qty;
    let s=(it.market-it.rcm)*it.qty;

    tQ+=it.qty; tM+=m; tR+=r; tPV+=pv; tSave+=s;

    let div=document.createElement("div");
    div.className="product-item";

    div.innerHTML=`
      <div style="flex:1">
        <div class="product-title">${it.name}</div>
        <div class="product-meta">MRP: ‚Çπ${fmt(it.market)} | RCM: ‚Çπ${fmt(it.rcm)} | PV: ${fmt(it.pv)}</div>
      </div>

      <div style="text-align:right">
        <div class="qty-controls">
          <button class="btn-ghost" data-i="${i}" data-a="minus">-</button>
          <input type="number" class="inline-qty" data-i="${i}" value="${it.qty}" min="1"
            style="width:50px;text-align:center">
          <button class="btn-ghost" data-i="${i}" data-a="plus">+</button>
        </div>
        <div style="margin-top:8px;font-weight:700;color:var(--accent)">‚Çπ${fmt(s)}</div>
      </div>
    `;
    productList.appendChild(div);
  });

  $("totalQty").innerText = "Qty: "+tQ;
  $("totalMarket").innerText = "Market: ‚Çπ"+fmt(tM);
  $("totalRCM").innerText = "RCM: ‚Çπ"+fmt(tR);
  $("totalPV").innerText = "PV: "+fmt(tPV);

  /* CONSISTENCY BONUS */
  let cons=0;
  if(tPV < 1500) cons = tPV * 0.12;
  else if(tPV < 2500) cons = 1500 * 0.1667;
  else cons = 5000 * 0.1667;

  let combined = tSave + cons;

  $("cardMonthly").innerText = "‚Çπ"+fmt(combined);
  $("cardCons").innerText    = "‚Çπ"+fmt(cons);
  $("cardAnnual").innerText  = "‚Çπ"+fmt(combined*12);
  $("cardTwenty").innerText  = "‚Çπ"+fmt(combined*12*20);

  /* QTY BUTTONS */
  document.querySelectorAll(".btn-ghost").forEach(b=>{
    b.onclick=()=>{
      let i=b.dataset.i;
      if(b.dataset.a==="plus") order[i].qty++;
      else order[i].qty = Math.max(1, order[i].qty-1);
      calc();
    };
  });

  document.querySelectorAll(".inline-qty").forEach(inp=>{
    inp.onchange=()=>{
      let i=inp.dataset.i;
      order[i].qty=Math.max(1, parseInt(inp.value)||1);
      calc();
    };
  });
}

/* CLEAR */
clearBtn.onclick = ()=>{
  if(confirm("Order Clear ‡§ï‡§∞‡§æ‡§Ø‡§ö‡§æ?")){
    order=[];
    calc();
  }
};

/* FULL WHATSAPP SUMMARY */
waBtn.onclick = ()=>{
  let msg = "üßæ *RCM Order Summary*\n\n";

  order.forEach((it,i)=>{
    msg += `${i+1}. ${it.name}\nQty: ${it.qty} | MRP: ${it.market} | RCM: ${it.rcm} | PV: ${it.pv}\n\n`;
  });

  msg += `*Totals*\n`;
  msg += `Market: ${$("totalMarket").innerText}\n`;
  msg += `RCM: ${$("totalRCM").innerText}\n`;
  msg += `PV: ${$("totalPV").innerText}\n`;
  msg += `Saving: ‚Çπ${fmt((tM-tR))}\n\n`;

  msg += `*Monthly:* ${$("cardMonthly").innerText}\n`;
  msg += `*Consistency:* ${$("cardCons").innerText}\n`;
  msg += `*Yearly:* ${$("cardAnnual").innerText}\n`;
  msg += `*20 Year:* ${$("cardTwenty").innerText}\n\n`;

  window.open("https://wa.me/?text="+encodeURIComponent(msg));
};

/* PREMIUM INVOICE PDF (OPTION B) */
pdfBtn.onclick = ()=>{

  let rows="";
  order.forEach((it,i)=>{
    rows += `| ${i+1} | ${it.name} | ${it.qty} | ${it.market} | ${it.rcm} | ${it.pv} | ${(it.market-it.rcm)*it.qty} |\n`;
  });

  let text = `
=========================================================
                     üåç DS WORLD ‚Äî RCM INVOICE üåç
                        Mobile : 7020970727
=========================================================

üßë Customer Details
---------------------------------------------------------
Name        :  ${$("custName").value}
AB / RCM ID :  ${$("rcmId").value}
Date        :  ${$("orderDate").value}
---------------------------------------------------------

üõí Order Summary
---------------------------------------------------------
| # | Product Name           | Qty | MRP | RCM | PV | Save |
---------------------------------------------------------
${rows}
---------------------------------------------------------

üìä Totals
---------------------------------------------------------
Total Market       :  ${$("totalMarket").innerText}
Total RCM          :  ${$("totalRCM").innerText}
Total PV           :  ${$("totalPV").innerText}
---------------------------------------------------------

üéÅ Bonus Summary
---------------------------------------------------------
Monthly Benefit    : ${$("cardMonthly").innerText}
Consistency Bonus  : ${$("cardCons").innerText}
Yearly Benefit     : ${$("cardAnnual").innerText}
20-Year Benefit    : ${$("cardTwenty").innerText}
---------------------------------------------------------

üôè ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶!
Best Wishes From  
‚ú® DS WORLD ‚Äî RCM PRO MAX ‚ú®
=========================================================
`;

  const el = document.createElement("div");
  el.style.whiteSpace="pre";
  el.style.fontFamily="monospace";
  el.style.padding="20px";
  el.innerText=text;

  html2pdf().from(el).save("RCM_Invoice.pdf");
};

/* ORDER POPUP OPEN */
placeOrderBtn.onclick = ()=> $("orderPopup").style.display="flex";

/* CLOSE POPUP */
closePopup.onclick = ()=> $("orderPopup").style.display="none";

/* SEND ORDER TO WHATSAPP 7020970727 */
sendOrderBtn.onclick = ()=>{

  let name = $("p_name").value;
  let mob  = $("p_mobile").value;
  let add  = $("p_address").value;

  if(!name || !mob || !add){
    alert("‡§∏‡§∞‡•ç‡§µ ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§≠‡§∞‡§æ!");
    return;
  }

  let msg = "üìù *New Order Received*\n\n";
  msg += `Name: ${name}\nMobile: ${mob}\nAddress: ${add}\n\n`;

  msg += "*Order Summary:*\n";
  order.forEach((it,i)=>{
    msg += `${i+1}. ${it.name} - Qty:${it.qty}\n`;
  });

  window.open("https://wa.me/7020970727?text="+encodeURIComponent(msg));

  $("orderPopup").style.display="none";
};

</script>
